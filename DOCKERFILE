# ================================
# Reposignal Backend Dockerfile
# Bun + Hono + Drizzle
# ================================

FROM oven/bun:1.3.4-alpine

# ---- Install system dependencies ----
RUN apk add --no-cache \
  bash \
  ca-certificates \
  openssl

# ---- Set working directory ----
WORKDIR /app

# ---- Copy dependency files first (better caching) ----
COPY package.json bun.lockb ./

# ---- Install dependencies ----
RUN bun install --frozen-lockfile

# ---- Copy application source ----
COPY . .

# ---- Environment defaults ----
ENV PORT=5000

# ---- Expose port (TEMPORARY: dev phase) ----
EXPOSE 5000

# ---- Start the server ----
CMD ["bun", "run", "start"]
